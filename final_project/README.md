# Прогнозирование оттока клиентов оператора связи

## Задача

Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.

## Используемые библиотеки

*Pandas* <br>
*Matplotlib* <br>
*Seaborn* <br>
*SkLearn* <br>
*CatBoost* <br>
*LightGBM* <br>

## План работы

1. Провести исследовательский анализ данных:
Посмотреть доступные данные, визуализировать их распределение и содержание, чтобы в дальнейшем выбрать нужные признаки и преобразовать типы данных;
2. Подготовка признаков:
Клиентские данные хранятся в 4 файлах - нужно объединить их в один датафрейм, на основе которого мы будем готовить признаки. Обработать пропуски, дубли и аномальные значения. Проверить мультиколлинеарность и отобрать признаки. Разделить выборку на обучающую и тестовую, масштабирование и балансировка;
3. Обучение и выбор модели: 
Обучить несколько моделей с целью выбора наиболее подходящей для задачи с помощью кросс-валидации, которая покажет наилучшую метрику;
4. Тестирование лучшей модели и вывод: 
Проверить лучшую модель на тестовой выборке и на адекватность, сделать вывод о результатах проделанной работы.

## Отчет
1. Какие пункты плана были выполнены, а какие — нет. Почему?<br>
*Все пункты плана и задача были успешно выполнены*<br><br>
2. Какие трудности возникли и как вы их преодолели?<br>
*Возникла сложность с выбором признаков, которые необходимо удалить, так как на первый взгляд под удаление попадало слишком много, что могло сказать на качестве модели. Однако кросс-валидация показала, что выбранных в итоге признаков было достаточно.*<br><br>
3. Какие ключевые шаги в решении задачи вы выделили?<br>
*Объединить данные и не потерять строки; заполнить пропуски, не понижая будущее качество модели; провести отбор признаков по корреляционному хитмепу, провести кодировку и масштабирование; проверить разные модели на кросс-валидации, выбрать лучшую и протестировать ее на отдельной выборке.*<br><br>
4. Какие признаки использовали для обучения модели и какая предобработка этих признаков была выполнена?<br>
*Для обучения модели использовались следующие признаки - количество дней с начала использования услуг компании, общие траты клиента на услуги, тип используемой подписки, кол-во дополнительных сервисов, которыми пользуется клиент, возможность использования параллельных телефонных линий, а также способ оплаты, кол-во иждевенцев, наличие партнера, наличие пенсионного статуса, пол, способ получения чека и используемый вид интернета. Категориальные признаки были закодированы с помощью техники OHE, количественные - масштабированы с помощью StandartScaler. Признак с количеством дней появился на основании разницы даты начала и конца использования услуг компании, а признак с кол-вом доп. услуг - сумма по полям с их списком.*<br><br>
5. Какая ваша итоговая модель, какие у неё гиперпараметы и какое качество?<br>
*Итоговая модель - LGBMClassifier(max_depth=3, n_estimators=700, num_leaves=60, random_state=140823). AUC-ROC на кросс-валидации - 0.914, на тесте - 0.927. Также модель показывает высокие результаты разметки не ушедших клиентов с precision - 0.93, recall - 0.99, f1-score - 0.96.*<br><br>
